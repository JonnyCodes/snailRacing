function t(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}var e=globalThis,n={},i={},a=e.parcelRequire4cf8;null==a&&((a=function(t){if(t in n)return n[t].exports;if(t in i){var e=i[t];delete i[t];var a={id:t,exports:{}};return n[t]=a,e.call(a.exports,a,a.exports),a.exports}var s=Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(t,e){i[t]=e},e.parcelRequire4cf8=a);var s=a.register;s("cmoHh",function(t,e){!function(t,e,n){function i(t){var e,n=this,i=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));e=i>>>0,i-=e,i*=e,e=i>>>0,i-=e,e+=4294967296*i}return(e>>>0)*23283064365386963e-26});n.next=function(){var t=2091639*n.s0+23283064365386963e-26*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=i(" "),n.s1=i(" "),n.s2=i(" "),n.s0-=i(t),n.s0<0&&(n.s0+=1),n.s1-=i(t),n.s1<0&&(n.s1+=1),n.s2-=i(t),n.s2<0&&(n.s2+=1)}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function s(t,e){var n=new i(t),s=e&&e.state,r=n.next;return r.int32=function(){return 4294967296*n.next()|0},r.double=function(){return r()+(2097152*r()|0)*11102230246251565e-32},r.quick=r,s&&("object"==typeof s&&a(s,n),r.state=function(){return a(n,{})}),r}e&&e.exports?e.exports=s:n&&n.amd?n(function(){return s}):this.alea=s}(0,t,"function"==typeof define&&define)}),s("euRi5",function(t,e){!function(t,e,n){function i(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function s(t,e){var n=new i(t),s=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,i=(t+e)/2097152;while(0===i)return i},r.int32=n.next,r.quick=r,s&&("object"==typeof s&&a(s,n),r.state=function(){return a(n,{})}),r}e&&e.exports?e.exports=s:n&&n.amd?n(function(){return s}):this.xor128=s}(0,t,"function"==typeof define&&define)}),s("hDsEw",function(t,e){!function(t,e,n){function i(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^(t^t<<1))|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function s(t,e){var n=new i(t),s=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,i=(t+e)/2097152;while(0===i)return i},r.int32=n.next,r.quick=r,s&&("object"==typeof s&&a(s,n),r.state=function(){return a(n,{})}),r}e&&e.exports?e.exports=s:n&&n.amd?n(function(){return s}):this.xorwow=s}(0,t,"function"==typeof define&&define)}),s("3J2Zm",function(t,e){!function(t,e,n){function i(t){var e=this;e.next=function(){var t,n,i=e.x,a=e.i;return t=i[a],t^=t>>>7,n=t^t<<24^((t=i[a+1&7])^t>>>10)^((t=i[a+3&7])^t>>>3)^((t=i[a+4&7])^t<<7),t=i[a+7&7],t^=t<<13,n^=t^t<<9,i[a]=n,e.i=a+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(n=0,e=""+e;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function s(t,e){null==t&&(t=+new Date);var n=new i(t),s=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,i=(t+e)/2097152;while(0===i)return i},r.int32=n.next,r.quick=r,s&&(s.x&&a(s,n),r.state=function(){return a(n,{})}),r}e&&e.exports?e.exports=s:n&&n.amd?n(function(){return s}):this.xorshift7=s}(0,t,"function"==typeof define&&define)}),s("6Px8M",function(t,e){!function(t,e,n){function i(t){var e=this;e.next=function(){var t,n,i=e.w,a=e.X,s=e.i;return e.w=i=i+1640531527|0,n=a[s+34&127],t=a[s=s+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=a[s]=n^t,e.i=s,n+(i^i>>>16)|0},function(t,e){var n,i,a,s,r,o=[],l=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,l=Math.max(l,e.length)),a=0,s=-32;s<l;++s)e&&(i^=e.charCodeAt((s+32)%e.length)),0===s&&(r=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,s>=0&&(r=r+1640531527|0,a=0==(n=o[127&s]^=i+r)?a+1:0);for(a>=128&&(o[127&(e&&e.length||0)]=-1),a=127,s=512;s>0;--s)i=o[a+34&127],n=o[a=a+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,o[a]=i^n;t.w=r,t.X=o,t.i=a}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function s(t,e){null==t&&(t=+new Date);var n=new i(t),s=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,i=(t+e)/2097152;while(0===i)return i},r.int32=n.next,r.quick=r,s&&(s.X&&a(s,n),r.state=function(){return a(n,{})}),r}e&&e.exports?e.exports=s:n&&n.amd?n(function(){return s}):this.xor4096=s}(0,t,"function"==typeof define&&define)}),s("lDm0S",function(t,e){!function(t,e,n){function i(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,i=e.d,a=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^a,a=a-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^a,e.a=a-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function s(t,e){var n=new i(t),s=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,i=(t+e)/2097152;while(0===i)return i},r.int32=n.next,r.quick=r,s&&("object"==typeof s&&a(s,n),r.state=function(){return a(n,{})}),r}e&&e.exports?e.exports=s:n&&n.amd?n(function(){return s}):this.tychei=s}(0,t,"function"==typeof define&&define)}),s("kjyEk",function(t,e){}),s("Ah4p2",function(e,n){t(e.exports,"RACE_LENGTH_KEY",()=>r),t(e.exports,"RaceLength",()=>o);var i=a("ayMG0"),s=a("b5ORo");let r="raceLength",o=()=>{let[t,e]=(0,s.default)(r,30);return(0,i.jsxs)("div",{className:"raceLength",children:[(0,i.jsx)("h2",{children:"Race length"}),(0,i.jsx)("input",{id:"raceLength",name:"raceLength",type:"range",min:"10",max:"60",value:t,onChange:t=>{t.preventDefault(),e(t.target.value)}}),(0,i.jsxs)("output",{children:["~",t," seconds"]})]})}}),s("joO0Q",function(e,n){t(e.exports,"SEED_KEY",()=>o),t(e.exports,"Seed",()=>l);var i=a("ayMG0"),s=a("mDWTX"),r=a("b5ORo");let o="seed",l=()=>{let[t,e]=(0,r.default)(o,(0,s.getRandomSeed)());return(0,i.jsxs)("div",{className:"seed",children:[(0,i.jsx)("h2",{children:"Seed"}),(0,i.jsx)("input",{type:"string",onChange:t=>{t.preventDefault(),e(t.target.value)},value:t}),(0,i.jsx)("button",{onClick:()=>{e((0,s.getRandomSeed)())},children:"Randomize"})]})}}),s("9NY5T",function(e,n){t(e.exports,"SNAILS_KEY",()=>l),t(e.exports,"Snails",()=>h);var i=a("ayMG0"),s=a("acw62"),r=a("b5ORo"),o=a("mDWTX");let l="snails",h=()=>{let[t,e]=(0,r.default)(l,[]),[n,a]=(0,s.useState)(""),[h,c]=(0,s.useState)((0,o.randomHexColor)()),d=(n,i)=>{let s={name:n.length?encodeURIComponent(n):encodeURIComponent(`Snail ${t.length+1}`),color:encodeURIComponent(i),number:t.length+1};e([...t,s]),a(""),c((0,o.randomHexColor)())},u=n=>{let i=t.filter(t=>t.number!==n);i.forEach((t,e)=>{t.number=e+1}),e(i)},f=t.length>=8;return(0,i.jsxs)("div",{className:"snails",children:[(0,i.jsx)("h2",{children:"Snails"}),(0,i.jsxs)("div",{className:"snails__add",children:[(0,i.jsx)("input",{type:"text",placeholder:"Name",onChange:t=>{a(t.target.value)},value:n}),(0,i.jsx)("input",{type:"color",onChange:t=>{c(t.target.value)},value:h}),(0,i.jsx)("button",{disabled:f,onClick:()=>d(n,h),children:"Add snail"})]}),(0,i.jsx)("ul",{className:"snails__list",children:t.map(t=>(0,i.jsxs)("li",{children:[t.number,": ",(0,i.jsx)("span",{style:{color:decodeURIComponent(t.color)},children:decodeURIComponent(t.name)})," ",(0,i.jsx)("span",{className:"snails__list__delete",onClick:()=>u(t.number),children:"X"})]},t.number))})]})}});var r=a("iuB9z"),o=a("fZj6v"),l=a("84MTf"),h=a("mDWTX"),c=a("4AGbv"),d=a("2Tywo"),u={},f=a("cmoHh"),p=a("euRi5"),x=a("hDsEw"),g=a("3J2Zm"),m=a("6Px8M"),w=a("lDm0S"),v={};!function(t,e,n){var i,s="random",r=n.pow(256,6),o=n.pow(2,52),l=2*o;function h(a,h,p){var x=[],g=u(function t(e,n){var i,a=[],s=typeof e;if(n&&"object"==s)for(i in e)try{a.push(t(e[i],n-1))}catch(t){}return a.length?a:"string"==s?e:e+"\0"}((h=!0==h?{entropy:!0}:h||{}).entropy?[a,f(e)]:null==a?function(){try{var n;return i&&(n=i.randomBytes)?n=n(256):(n=new Uint8Array(256),(t.crypto||t.msCrypto).getRandomValues(n)),f(n)}catch(n){var a=t.navigator,s=a&&a.plugins;return[+new Date,t,s,t.screen,f(e)]}}():a,3),x),m=new c(x),w=function(){for(var t=m.g(6),e=r,n=0;t<o;)t=(t+n)*256,e*=256,n=m.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return w.int32=function(){return 0|m.g(4)},w.quick=function(){return m.g(4)/4294967296},w.double=w,u(f(m.S),e),(h.pass||p||function(t,e,i,a){return(a&&(a.S&&d(a,m),t.state=function(){return d(m,{})}),i)?(n[s]=t,e):t})(w,g,"global"in h?h.global:this==n,h.state)}function c(t){var e,n=t.length,i=this,a=0,s=i.i=i.j=0,r=i.S=[];for(n||(t=[n++]);a<256;)r[a]=a++;for(a=0;a<256;a++)r[a]=r[s=255&s+t[a%n]+(e=r[a])],r[s]=e;(i.g=function(t){for(var e,n=0,a=i.i,s=i.j,r=i.S;t--;)e=r[a=255&a+1],n=256*n+r[255&(r[a]=r[s=255&s+e])+(r[s]=e)];return i.i=a,i.j=s,n})(256)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function u(t,e){for(var n,i=t+"",a=0;a<i.length;)e[255&a]=255&(n^=19*e[255&a])+i.charCodeAt(a++);return f(e)}function f(t){return String.fromCharCode.apply(0,t)}if(u(n.random(),e),v){v=h;try{i=a("kjyEk")}catch(t){}}else"function"==typeof define&&define.amd?define(function(){return h}):n["seed"+s]=h}("undefined"!=typeof self?self:v,[],Math),v.alea=f,v.xor128=p,v.xorwow=x,v.xorshift7=g,v.xor4096=m,v.tychei=w,u=v;var C=a("9Blbd"),y=a("jXtmt"),S=a("Ah4p2"),b=a("joO0Q"),N=a("9NY5T");const A=new URLSearchParams(window.location.search),k=A.get(y.RACE_NAME_KEY),E=A.get(C.RACE_SPONSOR_NAME_KEY),j=A.get(C.RACE_SPONSOR_LOGO_KEY),R=A.get(b.SEED_KEY),L=A.has(S.RACE_LENGTH_KEY)?parseInt(A.get(S.RACE_LENGTH_KEY)):30,T=A.has(N.SNAILS_KEY)?A.get(N.SNAILS_KEY):'[{ "name": "Foo", "color": "#ff0000", "number": 1 }]',_=new class{constructor(t){if(this.app=new r.Application,this.stage=this.app.stage,this.snails=[],this.raceStarted=!1,this.raceComplete=!1,this.showResults=!1,this.raceDetails={length:600*t.raceLength,raceName:t.raceName||void 0,raceSponsorName:t.raceSponsorName||void 0,raceSponsorLogo:t.raceSponsorLogo||void 0},this.cameraContainer=new o.CameraContainer(this.raceDetails.length,window.innerHeight),this.elapsedMS=this.tickCount=0,this.tickLengthMS=1e3,this.onCompleteCallback=t.onComplete,this.finishLineX=0,this.finishers=[],null!==t.randomSeed){var e;((e=u)&&e.__esModule?e.default:e)(t.randomSeed,{global:!0})}t.snails.forEach(t=>{this.snails.push(new l.Snail(t))})}async load(){let t=[];this.snails.forEach(e=>{let n=(0,h.randomIntBetween)(1,6);t.push(e.load(n))}),t.push((0,r.Assets).load({alias:"Super Lobster",src:"./super_lobster.ttf"})),t.push((0,r.Assets).load({alias:"cloudLayer",src:"./cloudLayer1.png"})),t.push((0,r.Assets).load({alias:"backgroundMountains",src:"./mountains.png"})),t.push((0,r.Assets).load({alias:"hills",src:"./hills.png"})),t.push((0,r.Assets).load({alias:"groundLayer",src:"./groundLayer1.png"})),t.push((0,r.Assets).load({alias:"cloud1",src:"./cloud1.png"})),t.push((0,r.Assets).load({alias:"cloud2",src:"./cloud2.png"})),t.push((0,r.Assets).load({alias:"cloud3",src:"./cloud3.png"})),t.push((0,r.Assets).load({alias:"cloud4",src:"./cloud4.png"})),t.push((0,r.Assets).load({alias:"signage",src:"./signage.png"})),t.push((0,r.Assets).load({alias:"track",src:"./track.png"})),await Promise.all(t)}init(t){this.app.init({resizeTo:window,backgroundColor:12052474,sharedTicker:!0,...t}).then(()=>{if(document.body.appendChild(this.app.canvas),this.finishLineX=this.raceDetails.length+.75*this.app.canvas.width,this.stage.addChild(this.cameraContainer),[{textureName:"cloudLayer",zIndex:.01,x:"tiled",y:0},{textureName:"backgroundMountains",zIndex:.05,x:"tiled",y:10,tint:14543842},{textureName:"cloud1",zIndex:.02,x:{min:0,max:(this.cameraContainer.fullWidth+this.app.canvas.width)*.02},y:{min:-50,max:100}},{textureName:"cloud2",zIndex:.06,x:{min:0,max:(this.cameraContainer.fullWidth+this.app.canvas.width)*.06},y:{min:-50,max:100}},{textureName:"hills",zIndex:.075,x:"tiled",y:100,tint:11523774},{textureName:"cloud3",zIndex:.08,x:{min:0,max:(this.cameraContainer.fullWidth+this.app.canvas.width)*.08},y:{min:-50,max:100}},{textureName:"cloud4",zIndex:.15,x:{min:0,max:(this.cameraContainer.fullWidth+this.app.canvas.width)*.15},y:{min:-50,max:100}},{textureName:"groundLayer",zIndex:.1,x:"tiled",y:175,tint:8239720},{textureName:"signage",zIndex:1,x:"tiled",y:240},{textureName:"track",zIndex:1,x:"tiled",y:"tiled",offsetY:400}].forEach(t=>{let e=(0,r.Texture).from(t.textureName),n=new r.Point(1);"tiled"===t.x&&(n.x=Math.ceil(this.app.canvas.width/e.width+this.cameraContainer.fullWidth/e.width*(0,h.getConfigValue)(t.zIndex))+1),"tiled"===t.y&&(n.y=Math.ceil(this.app.canvas.height/e.height+this.cameraContainer.fullHeight/e.height*(0,h.getConfigValue)(t.zIndex))+1);let i=new o.ParallaxChild;for(let a=0;a<n.x;a++){let s=(0,r.Sprite).from(e),o="tiled"===t.x?s.width*a:(0,h.getConfigValue)(t.x);if("tiled"===t.y){s.position.set(o+(0,h.getConfigValue)(t.offsetX),(0,h.getConfigValue)(t.offsetY)),s.tint=t.tint??16777215,i.addChild(s);for(let a=1;a<n.y;a++){let n=(0,r.Sprite).from(e),l=s.height*a;n.position.set(o+(0,h.getConfigValue)(t.offsetX),l+(0,h.getConfigValue)(t.offsetY)),n.tint=t.tint??16777215,i.addChild(n)}}else{let e=(0,h.getConfigValue)(t.y);s.position.set(o+(0,h.getConfigValue)(t.offsetX),e+(0,h.getConfigValue)(t.offsetY)),s.tint=t.tint??16777215,i.addChild(s)}}this.cameraContainer.addChildAtZ(i,(0,h.getConfigValue)(t.zIndex))}),this.raceDetails.raceName||this.raceDetails.raceSponsorName){let t=new r.Text({text:`${this.raceDetails.raceName??""}${this.raceDetails.raceName&&this.raceDetails.raceSponsorName?" sponsored by ":""}${this.raceDetails.raceSponsorName??""}`,style:{fill:14540253,fontFamily:"Super Lobster",fontSize:120,fontWeight:"bold",stroke:{color:16933,width:10,join:"round"}}}),e=new o.ParallaxChild,n=Math.floor(this.finishLineX/(2*t.width));for(let i=1;i<n+1;i++){let a=new r.Text({text:t.text,style:t.style});a.position.set(this.finishLineX/(n+1)*i-a.width/2,235),e.addChild(a)}this.cameraContainer.addChildAtZ(e,1)}let t=new o.ParallaxChild,e=new(0,r.Graphics)().moveTo(350,400).lineTo(300,this.app.canvas.height).stroke({color:16777215,width:10});t.addChild(e),this.cameraContainer.addChildAtZ(t,1);let n=new o.ParallaxChild,i=new(0,r.Graphics)().moveTo(this.finishLineX,400).lineTo(this.finishLineX+100,this.app.canvas.height).stroke({color:16777215,width:10});n.addChild(i),this.cameraContainer.addChildAtZ(n,1),(0,r.Ticker).shared.add(t=>this.update(t)),this.snails.forEach(t=>t.create()),this.showSnailsUI(),this.snails.reverse().forEach((t,e)=>{this.cameraContainer.addChildAtZ(t.container),t.updatePositionBy(150+-10*e,400-.8*t.container.height+e*((this.app.canvas.height-400)/this.snails.length),!0)})})}showSnailsUI(){let t=new(0,r.Graphics)().rect(0,0,this.app.canvas.width,this.app.canvas.height).fill({color:0,alpha:.66});this.stage.addChild(t);let e=new(0,r.Graphics)().roundRect(0,0,this.app.canvas.width/4*2,700,15).stroke({color:0,width:6}).fill(11256276);e.position.set(this.app.canvas.width/4,100),this.stage.addChild(e);let n=(0,r.RenderTexture).create({width:(this.snails[0].container.width+50)*this.snails.length,height:this.snails[0].container.height+50,scaleMode:"linear"});for(let t=0;t<this.snails.length;t++){let e=this.snails[t];e.container.position.set((e.container.width+50)*t,0);let i=new r.Text({text:e.config.name,style:{fill:16777215,fontFamily:"Super Lobster",fontSize:30,stroke:{color:0,width:4,join:"round"}}});i.position.set(e.container.x+(e.container.width-i.width)/2,e.container.y+e.container.height+5),this.app.renderer.render({container:e.container,target:n,clear:!1}),this.app.renderer.render({container:i,target:n,clear:!1})}let i=0,a=(0,r.Sprite).from(n);a.scale.set(1.5),a.position.set(e.x+(e.width-1.5*this.snails[0].container.width)/2,e.y+100),this.stage.addChild(a);let s=new(0,r.Graphics)().roundRect(e.x+(e.width-1.5*this.snails[0].container.width)/2,e.y+100,1.5*this.snails[0].container.width+10,a.height).fill(16777215);a.mask=s;let o=new(0,r.Graphics)().roundPoly(0,0,100,3,10,Math.PI/2).stroke({color:0,width:6}).fill(2088616);o.scale.x=.6,o.position.set(a.x+450,e.y+250),o.interactive=!0,o.cursor="hand",this.stage.addChild(o),o.onpointerup=()=>{i++,a.position.x=e.x+(e.width-1.5*this.snails[0].container.width)/2-i*((this.snails[0].container.width+50)*1.5),i<this.snails.length-1?(o.interactive=!0,o.alpha=1):(o.interactive=!1,o.alpha=.1),i>0?(l.interactive=!0,l.alpha=1):(l.interactive=!1,l.alpha=.1)};let l=new(0,r.Graphics)().roundPoly(0,0,100,3,10,Math.PI/2).stroke({color:0,width:6}).fill(2088616);l.scale.x=-.6,l.position.set(a.x-175,e.y+250),l.interactive=!1,l.alpha=.1,l.cursor="hand",this.stage.addChild(l),l.onpointerup=()=>{i--,a.position.x=e.x+(e.width-1.5*this.snails[0].container.width)/2-i*((this.snails[0].container.width+50)*1.5),i>0?(l.interactive=!0,l.alpha=1):(l.interactive=!1,l.alpha=.1),i<=this.snails.length-1?(o.interactive=!0,o.alpha=1):(o.interactive=!1,o.alpha=.1)};let h=new r.Container,c=new(0,r.Graphics)().roundRect(0,0,300,50,10).stroke({color:0,width:6}).fill(2088616);h.position.set(e.x+(e.width-c.width)/2,e.height),h.addChild(c);let d=new r.Text({text:"Start Race",style:{fill:0,fontFamily:"Super Lobster",fontSize:30}});d.position.set((c.width-d.width)/2,7),h.addChild(d),h.interactive=!0,h.cursor="hand",this.stage.addChild(h),h.onpointerup=()=>{let n=[t,e,h,s,a,l,o];this.stage.removeChild(...n),n.forEach(t=>t.destroy()),this.startCountdownText(5,()=>this.raceStarted=!0)}}startCountdownText(t,e){let n=new r.Text({text:t.toString(),style:{fill:3===t?16711680:2===t?16746496:1===t?65280:16777215,fontSize:500,fontWeight:"bold",stroke:{color:0,width:5,join:"round"}}});return n.anchor.set(.5),n.position.set(this.app.canvas.width/2,this.app.canvas.height/2),this.stage.addChild(n),(0,c.default).to(n,{duration:1,alpha:0,ease:d.Sine.easeIn}),(0,c.default).fromTo(n.scale,{x:0,y:0},{duration:1,x:1,y:1,ease:d.Sine.easeOut,onComplete:()=>{this.stage.removeChild(n),1===t?e():this.startCountdownText(t-1,e)}})}finishRace(){this.showResults=!0,setTimeout(()=>{this.onCompleteCallback&&this.onCompleteCallback(this.finishers,this.raceDetails)},250)}update(t){if(!this.showResults){this.raceStarted&&(this.elapsedMS+=t.elapsedMS,this.tickCount+=t.elapsedMS,this.tickCount>this.tickLengthMS&&(this.tickCount=0,this.snails.forEach(t=>{t.changeSpeed()})),this.snails.forEach(e=>{e.update(t.deltaTime),!(e.container.originalPosition.x+e.container.width/3>this.finishLineX)||e.finished||(e.finished=!0,this.finishers.push({...e.config,time:this.elapsedMS,bodyAssetNum:e.bodyAssetNum}),this.raceComplete||this.finishers.length!==this.snails.length||(this.raceComplete=!0,setTimeout(()=>this.finishRace(),1250)))}));let e=this.snails.reduce((t,e)=>t.container.originalPosition.x>=e.container.originalPosition.x?t:e,this.snails[0]);this.cameraContainer.moveCameraTo(e.container.originalPosition.x-this.app.canvas.width/2,0)}}}({raceName:k,raceSponsorName:E,raceSponsorLogo:j,raceLength:L,randomSeed:R,snails:JSON.parse(T),onComplete:(t,e)=>{let n=t.map(t=>({...t,name:encodeURIComponent(t.name),color:encodeURIComponent(t.color),time:t.time})),i=`./finished.html?snails=${JSON.stringify(n)}`;i+="&"+Object.entries(e).filter(([t,e])=>!!e).map(([t,e])=>`${t}=${e}`).join("&"),window.location.href=i}});_.load().then(()=>{_.init()});
//# sourceMappingURL=game.3758e39d.js.map
